---
extends: minimal.j2
default_block: main
title: TelFit
description: 
---

<h1>TelFit</h1>
<h2>An Object-Oriented Framework for Fitting the Telluric Absorption Spectrum</h2>
<hr/>

<p>TelFit is a Python code I wrote specifically to fit the telluric absorption spectrum in astronomical data. I have been using it extensively in my project searching for companions to A and B stars, but it is sufficiently general that it should work on any data. The code is essentially a wrapper to <a href="http://rtweb.aer.com/lblrtm.html">LBLRTM</a>, the Line-By-Line Radiative Transfer Model. It vastly simplifies the process of generating a telluric model, and can efficiently remove the telluric absorption lines in my high-resolution echelle spectra of A and B stars. I have done some test on late-type stellar spectra as well with good results. I am currently working on a paper officially announcing this code and describing it in some detail; check back here for the link once it is up! You can download the source code below, which includes both LBLRTM and my wrapper. See my <a href="http://github.com/kgullikson88/Telluric-Fitter">GitHub page</a> for details and for the "bleeding edge" code.
</p>

<p>TelFit is packaged with LBLRTM. If you download TelFit, please also go <a href="http://rtweb.aer.com/lblrtm_download.php" target="_blank">here</a> to inform the developers of LBLRTM. This helps them keep track of who is using the code and informs future code development.
</p>

<p>I will try my best to respond to questions about/problems with the code. However, I am busy and may not be able to help your or may not respond for quite some time. I encourage you to submit issues <a href="https://github.com/kgullikson88/Telluric-Fitter/issues">here</a> rather than emailing me.</p>

<h3> <a href="{{ media_url('code/TelFit-0.3.tar.gz') }}"> TelFit code</a> </h3>
<h3> <a href="{{ media_url('pdfs/TelFit_Manual.pdf') }}">TelFit Manual (pdf)</a> </h3>


<hr/>


<h2>Frequently Asked Questions</h2>

<ol>
<li>I am getting an error about the keyword 'TelluricModeling' not set.<br><br>
     
     During the installation process, you should have been prompted to let TelFit put
     a command like "export TELLURICMODELING=/home/user/TelFit/" in you bash setup file (~/.bashrc). If you did this, you need to source that script. If you did not, you will need to export the TELLURICMODELING environment variable to point to the directory containing your rundir directories.<br><br></li>

<li>TelFit is converging on a solution with too abundances that are too low and a 
    resolution that is too high.<br><br>
    
    I am not sure why it does this, but constraining the resolution to be close to the actual value usually helps. You can also constrain the molecule abundance that is causing problem, but that is usually not known as well as the detector resolution.<br><br></li>

<li>The corrected spectra have what appear to be <a href="http://www.ifa.hawaii.edu/~kud/windsfromhotstars/plots/fig2m31fin.gif">P Cygni profiles</a>.<br><br>

    This is a wavelength solution error, and sometimes happens in very deep and very steep telluric lines such as the oxygen bands in the visible spectrum. You can improve the situation with the keyword argument 'wavelength_fit_order' in your Fit() call. Give it an order > 3, which is the default value.<br><br></li>

<li>How do I fit the tellurics when there are other lines present?<br><br>
    
    There are several ways around this, and the best one depends on your exact situation. If you have a decent (doesn't need to be great) model for the source spectrum, remove it from the spectrum before the telluric fit. You can also ignore wavelength regions in the cost function calculation with the "IgnoreRegions" command. See the TelFit manual for more details.<br><br></li>
</ol>
